# installing docker on centos host
- name: Install Docker for CentOS Stream
  hosts: 192.168.1.201
  remote_user: root

  tasks:
  - name: Add docker repo
    yum_repository: 
      name: docker_ce
      description: Docker repo
      baseurl: https://download.docker.com/linux/centos/$releasever/$basearch/stable

  - name: Delete podman
    dnf:
      name: podman
      state: absent
      autoremove: yes

  - name: Delete containers-common
    dnf:
      name: containers-common
      state: absent
      autoremove: yes

  - name: Update all installed packages
    dnf:
      name: "*"
      state: latest
  
  - name: Install Docker packages
    dnf:
      name: 
        - docker-ce
        - docker-ce-cli
        - containerd.io
        - docker-compose-plugin
      state: latest
      disable_gpg_check: yes
  
  - name: Enable Docker daemon
    ansible.builtin.systemd:
      name: docker
      enabled: yes
  
  - name: Start Docker daemon
    ansible.builtin.systemd:
      name: docker
      state: started
